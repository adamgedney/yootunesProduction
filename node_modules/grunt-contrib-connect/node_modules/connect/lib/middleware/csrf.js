/*!
 * Connect - csrf
 * Copyright(c) 2011 Sencha Inc.
 * MIT Licensed
 */

function defaultValue(e){return e.body&&e.body._csrf||e.query&&e.query._csrf||e.headers["x-csrf-token"]}var utils=require("../utils");module.exports=function(t){t=t||{};var n=t.value||defaultValue;return function(e,t,r){var i=e.session._csrf||(e.session._csrf=utils.uid(24));if("GET"==e.method||"HEAD"==e.method||"OPTIONS"==e.method)return r();var s=n(e);if(s!=i)return r(utils.error(403));r()}};
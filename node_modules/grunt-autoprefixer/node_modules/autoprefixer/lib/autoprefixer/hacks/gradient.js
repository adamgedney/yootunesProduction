(function(){var e,t,n,r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=require("../old-value"),n=require("../value"),i=require("../utils"),r=new RegExp("(top|left|right|bottom)","gi"),e=function(e){function f(e,t){this.name=e,this.prefixes=t,this.regexp=f.regexps[this.name]}var n,s,u,a;o(f,e),f.names=["linear-gradient","repeating-linear-gradient","radial-gradient","repeating-radial-gradient"],f.starts=new RegExp("(^|\\s*)"+f.names.join("|"),"i"),f.regexps={},a=f.names;for(s=0,u=a.length;s<u;s++)n=a[s],f.regexps[n]=new RegExp("(^|\\s|,)"+n+"\\((.+)\\)","gi");return f.prototype.addPrefix=function(e,t){var n=this;return t.replace(this.regexp,function(t,r,i){var s,o,u,a,f;o=[],f=n.splitDecls(t);for(u=0,a=f.length;u<a;u++)s=f[u],o.push(s.replace(n.regexp,function(t,r,i){var s;return s=n.splitParams(i),s=n.newDirection(s),e==="-webkit- old"?n.name!=="linear-gradient"?t:s[0]&&s[0].indexOf("deg")!==-1?t:i.indexOf("-corner")!==-1?t:i.indexOf("-side")!==-1?t:(s=n.oldDirection(s),s=n.colorStops(s),"-webkit-gradient(linear, "+s.join(", ")+")"):(s.length>0&&(s[0].slice(0,3)==="to "?s[0]=n.fixDirection(s[0]):s[0].indexOf("deg")!==-1?s[0]=n.fixAngle(s[0]):s[0].indexOf(" at ")!==-1&&n.fixRadial(s)),r+e+n.name+"("+s.join(", ")+")")}));return o.join(",")})},f.prototype.directions={top:"bottom",left:"right",bottom:"top",right:"left"},f.prototype.oldDirections={top:"left bottom, left top",left:"right top, left top",bottom:"left top, left bottom",right:"left top, right top","top right":"left bottom, right top","top left":"right bottom, left top","bottom right":"left top, right bottom","bottom left":"right top, left bottom"},f.prototype.splitDecls=function(e){var t,r,i,s,o;i=[],t=e.split(","),r=[];for(s=0,o=t.length;s<o;s++)n=t[s],f.starts.test(n)?r.length===0?r.push(n):(i.push(r.join(",")),r=[n]):r.push(n);return i.push(r.join(",")),i},f.prototype.splitParams=function(e){var t,n,r,i,s,o;t=[],i="",r=0;for(s=0,o=e.length;s<o;s++)n=e[s],n===")"&&r>0?(r-=1,i+=n):n==="("?(i+=n,r+=1):r>0?i+=n:n===","?(t.push(i.trim()),i=""):i+=n;return t.push(i.trim()),t},f.prototype.newDirection=function(e){var t,n;return t=e[0],t.indexOf("to ")===-1&&r.test(t)&&(t=t.split(" "),t=function(){var e,r,i;i=[];for(e=0,r=t.length;e<r;e++)n=t[e],i.push(this.directions[n.toLowerCase()]||n);return i}.call(this),e[0]="to "+t.join(" ")),e},f.prototype.fixDirection=function(e){var t;return e=e.split(" "),e.splice(0,1),e=function(){var n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.directions[t.toLowerCase()]||t);return i}.call(this),e.join(" ")},f.prototype.roundFloat=function(e,t){return parseFloat(e.toFixed(t))},f.prototype.fixAngle=function(e){return e=parseFloat(e),e=Math.abs(450-e)%360,e=this.roundFloat(e,3),""+e+"deg"},f.prototype.fixRadial=function(e){var t;return t=e[0].split(/\s+at\s+/),e.splice(0,1,t[1],t[0])},f.prototype.oldDirection=function(e){var t;return e.length===0&&e,e[0].indexOf("to ")!==-1?(t=e[0].replace(/^to\s+/,""),t=this.oldDirections[t],e[0]=t,e):(t=this.oldDirections.bottom,[t].concat(e))},f.prototype.colorStops=function(e){return e.map(function(t,n){var r,i,s;return n===0?t:(s=t.lastIndexOf(" "),s===-1?(r=t,i=void 0):(r=t.slice(0,s),i=t.slice(s+1)),i&&i.indexOf(")")!==-1&&(r+=" "+i,i=void 0),n===1?"from("+r+")":n===e.length-1?"to("+r+")":i?"color-stop("+i+", "+r+")":"color-stop("+r+")")})},f.prototype.old=function(e){var n,r,s;return e==="-webkit-"?(s=this.name==="linear-gradient"?"linear":"radial",r="-gradient",n=i.regexp("-webkit-("+s+"-gradient|gradient\\(\\s*"+s+")",!1),new t(e+this.name,r,n)):f.__super__.old.apply(this,arguments)},f}(n),module.exports=e}).call(this);